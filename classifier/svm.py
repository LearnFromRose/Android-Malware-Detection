import numpy as np
import scipy.io as io
from sklearn import svm
from sklearn.metrics import classification_report
from sklearn.externals import joblib


if __name__ == '__main__':
    X = io.loadmat("..\\dataset\\benignAndStormDroid\\A.mat")['X']
    Y = io.loadmat("..\\dataset\\benignAndStormDroid\\A.mat")['Y']

    print(X.shape, Y.shape)
    print(Y.sum())
    index = [i for i in range(len(X))]
    # Set random seed
    seed = 123
    np.random.seed(seed)
    np.random.shuffle(index)
    X = X[index]
    Y = Y[index]
    train_X, train_Y, test_X, test_Y = X[:700], Y[:700], X[700:], Y[700:]
    # print(train_X.shape, train_y.shape, test_X.shape, test_y.shape)
    model = svm.SVC(C=1.0, kernel='linear')
    model.fit(train_X, train_Y.ravel())
    joblib.dump(model, "train_model.m")
    print(classification_report(test_Y, model.predict(test_X)))
